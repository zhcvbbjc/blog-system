<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title ?: '智能博客系统'}">智能博客系统</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/admin.css}" th:if="${adminPage}">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar" th:unless="${hideNavbar}">
        <div class="navbar-container">
            <a href="/" class="navbar-brand">📝 智能博客</a>
            
            <ul class="navbar-nav">
                <li><a href="/">首页</a></li>
                <li><a href="/tags">标签</a></li>
                <li><a href="/about">关于</a></li>
            </ul>

            <div class="navbar-search">
                <input type="text" id="searchInput" placeholder="搜索文章...">
                <button class="btn btn-primary" onclick="search()">搜索</button>
            </div>

            <div class="navbar-user">
                <div class="user-menu" th:if="${user}">
                    <img th:src="${user.avatarUrl ?: '/images/default-avatar.png'}" 
                         alt="用户头像" class="user-avatar" 
                         onclick="toggleDropdown()">
                    <div class="dropdown-menu" id="userDropdown">
                        <a href="/profile">个人中心</a>
                        <a href="/admin" th:if="${user.role == 'ADMIN'}">后台管理</a>
                        <a href="#" onclick="logout()">退出登录</a>
                    </div>
                </div>
                <div th:unless="${user}">
                    <a href="/login" class="btn btn-outline">登录</a>
                    <a href="/register" class="btn btn-primary">注册</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主要内容 -->
    <main th:replace="${content}"></main>

    <!-- 页脚 -->
    <footer class="text-center mt-3 mb-1" th:unless="${hideNavbar}">
        <p>&copy; 2024 智能博客系统. All rights reserved.</p>
    </footer>

    <script th:src="@{/js/main.js}"></script>
    <script th:src="@{/js/admin.js}" th:if="${adminPage}"></script>
</body>
</html>

